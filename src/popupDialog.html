<!DOCTYPE html>
<html>
<head>
  <title>Team Member Randomizer</title>
  <script src="scripts/shim.js"></script>
  <script src="scripts/popup.js"></script>
  <script src="../node_modules/vss-web-extension-sdk/lib/VSS.SDK.min.js"></script>
  <style>
    .bold {
      font-weight: bold;
    }

    .completed {
      text-decoration: line-through;
      color: #999;
    }

    #canvas {
      display: none;
    }
    body { 
      padding:10px;
    }
    #completePanel {
      margin-bottom:10px;
    }
  </style>
</head>
<body style="background-color:inherit">
  <section id="completePanel">
    <canvas id="canvas"></canvas>
    <p id="message"></p>
  </section>      
  
  <p id="question"></p>
  <div id="controls">
    <button id="buttonNext">Next</button>
    <button id="buttonStartOver">Start Over</button>
  </div>
  <table id="team"></table>

  <script type="text/javascript">
    "use strict";
    if(isDevEnvironment())
      setupDevShim();

    const team = document.getElementById("team");
    const canvas = document.getElementById("canvas");
    const message = document.getElementById("message");
    const question = document.getElementById("question");
    const buttonNext = document.getElementById("buttonNext");
    const buttonStartOver = document.getElementById("buttonStartOver");

    VSS.init({ usePlatformScripts: true, usePlatformStyles: true });

    VSS.require(["VSS/Service", "TFS/Core/RestClient"], (VSS_Service, TFS_RestClient) => {
      const _client = VSS_Service.getCollectionClient(TFS_RestClient.CoreHttpClient4_1);
      const webContext = VSS.getWebContext();
      loadData(_client,webContext)
      VSS.notifyLoadSucceeded();
    });
  </script>
</body>
</html>
